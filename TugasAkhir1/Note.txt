Note for TA:

#Image Decomposition(Done) - 25/01/2016
	Decompose Image into 2 level DWT. Using Haar Wavelet Transform.

#Watermark Scrambling(Done) - 13/02/2016
	- 1/3 Convolution Code(Done)
	- Direct Sequence Spread Spectrum with PN Sequence generated by Secret Key
	- Interleaving, interleave the DSSS sequence using randomly generate sequence

#Design HMM Tree of the wavelet Domain

#Estimate parameter for model HMM
------------------------------------------------------------------------------------------------

Wavelet coefficients adalah nilai-nilai pixel setelah gambar di decompose kedalam domain DWT.

127 adalah nilai pixel/wavelet coefficients yang paling banyak muncul, threshold untuk state HMM adalah 1 => pixel>127 dan 2 => pixel<=217

Struktur HMM: 

> Hidden States			= {1,2} : 2 
> Observation			= {Wi....Wn} : The Wavelet Coefficients
> Start Probability		= {P(S=1), P(S=2)} : probability of each states
> Transition Probability= {
							1 -> 1 , 1 -> 2
							2 -> 1 , 2 -> 2
						  }


*Based on Wikipedia: https://en.wikipedia.org/wiki/Hidden_Markov_model

---------

Sifat-sifat wavelet coefficients:
- Pada domain DWT, terdapat nilai-nilai wavelet coefficients yang dapat dibagi menjadi 2 kategori:
  - "High" Wavelet Coefficient : yaitu nilai wavelet yang tinggi
  - "Low" Wavelet Coefficient : yaitu nilai wavelet yang rendah
- Setelah proses wavelet transform, distribusi nilai wavelet memiliki kecenderungan untuk nilai tinggi yang jarang muncul, sedangkan
  nilai yang rendah sangat sering muncul pada gambar.

	Untuk setiap wavelet coefficient, ada state yang berlaku terhadapnya. Pada kasus kali ini, akan ditentukan 2 states
yaitu state 1 untuk nilai wavelet coeff. yang tinggi dan state 2 untuk nilai wavelet coeff. yang rendah.

	Untuk setiap wavelet coeff. ada probabilitas zero-mean gaussian mixture model yang merupakan gabungan antara probabilitas nilai coefficeiens yang tinggi
dikali niali gaussiannya dengan probabilitas nilai coeff yang rendah dikali dengan nilai gaussiannya juga.
"..--the result is a two-state mixture model for each wavelet coefficient...."(Wavelet-Based Statistical Signal Processing using Hidden Markov Model)

---------
"...Wavelet Coefficients at the same subband are tied together to share the same statistic..."(WDHMM_trans)


---------
Bimbingan 2: pak cok
-> Hal-hal minor boleh diganti
-> Teknik Scramble bebas(boleh gak di scramble)

---------
Code:
x >> y = x/(y*2)
x << y = x*(y*2)

---------
Python pywt library for Haar Wavelet Transform used matrix transformation:
	[ 1/sqrt(2)  1/sqrt(2) ]
	[ 1/sqrt(2) -1/sqrt(2) ]

---------
Wavelet Coefficients FIXED HAHAHHAHHA!!!!


---------
According to pywt python library for Discrete Wavelet Transform, this is what this code will looks like:
	 ______________________
	|			|		   |
	|    LL     |   LH     |
	|           |          |
	|___________|__________|
	|           |          |
	|    HL     |   HH     |
	|           |          |
	|___________|__________|

---------
First Experiment:
	- Try to implement watermark embedding in maximum value of variance of (Paper amini2014)


---------
Batasan TA:
	- Image Size must be 2^n x 2^n
	- Because the pairing up mechanism in Haar Wavelet Transform, if it's not like this, then the error result wrong wavelet coefficients.

---------
Strange??
	Why do the images sometime agree with 2^n images, sometime not??


---------
Probability of Hidden States transition is	Probability that the child node is in state n(n=1,2) given its parent node is in state m(m=1,2)
--> P(m->n) = P(n|m)
--> state probability of child node -> P(n) = P(n|m)P(m)
--> Note :
	p(n) = State Probability of Child nodes.
	p(n|m) = State probability of child node given parent nodes.
	p(m) = State probability of parent nodes.

---------
For every Quad Tree(1 parent node, 4 child node), there is WD-HMM Model for them. 

---------
J = Level = 1,2,3...
For this , 2.

---------
Bimbingan 3:
	- embed watermark using paper's method:
		- Create M-bit segment(M=5) , then map each segment into 15 bit with mapping method.
		- Embed those 15 mapped bit into each 15 node tree HMM
	- Extract watermark using paper's method:
		- Create HMM model from quad trees in DWT domain in embedded image
		- Estimate HMM model from its parameter
		- Use this estimated value as given value in likelihood probability calculation.
		- Calculate the Maximum Likelihood probability.
---------
Progress: 
	- Scramble -> Succeed
	- Forward DWT -> Succeed
	- Embedding -> Succeed
	- HVS -> Succeed
	- Inverse DWT -> Succeed

---------
How to calculate Covariance matrix for Multivariate mixture Gaussian model:
	- Vector of wavelet coefficients * transpose of vector of wavelet coefficients -> W(j,k) * transpose(W(j,k))

---------
Threshold untuk State Value adalah rata-rata dari keseluruhan wavelet coefficients yang dijumlahkan.

---------
Model Mixture-Gaussian applied to EACH Wavelet Coefficient.

---------
HMM Model Parameters Estimation:
	- Scalar DWT-HMM:
		- 2 Mixture variances for the wavelet coefficients at each scale.
		- 2 probabilities for the root state probabilities(at the coarsest scale, scale 1).
		- 2x2 matrices of state transition probabilities for child scale(scale 2).
		- Parameter = {P1,A2,Variance} (m=1,2)
	- Vector DWT-HMM:
		- 2 covariance matrix from vector of wavelet coefficients from same scale and location in different subband.
		- 2 probabilities for the root state probabilities(at the coarsest scale, scale 1).
		- 2x2 matrices of state transition probabilities for child scale(scale 2).
		- Parameter = {P1,A2,CovMatrix} (m=1,2)

--------
Rule for Optimal mapping strategy:
	1. Mapped watermark should be designed to modify the vector tree randomly while their distance is kept.
	2. Parents node should be preferably chosen to embed the watermark.

--------
One HMM Model is for whole tree in input image.

--------
The detail coefficients in scale 1 have pattern like :(doubt)
|  x  |	 y	|  x and y showing value 
|__1__|__2__|  1 & 3 always same
|  x  |	 y	|  2 & 4 always same
|__3__|__4__|

--------
We use PDF F(w) for each wavelet coefficients if the wavelet coefficients are independent each other.

--------
Using manual HMM parameter estimation -> pathetic accuration
using Baum-Welch HMM parameter estimation and detection -> accuration for lena baboon around 50.8 %(before inverse DSSS)

--------
Things to be saved in Key:
	- PN Sequence
	- size of watermark m x n

--------
To Do:
	- Normalize wavelet coefficients -> Training
	- While detecting -> Normalize (wavelet coefficients - table of watermark permutation)
	- calculate likelihood from (normalized extracted watermark - table of watermark permutation) given model
	  -> Result : High BER(BAD)

--------
To Do:
	- After scrambled into W x 5 Scrambled watermark
	- Watermark is then set into subband LH1 and LH2 as tree
	Done!

--------
To Do:
	- Create function that return 2 patterns possibility embedded in to watermark based on PNSeq.
	Done!
	Result: Acuration: 61.962962962963

--------
Penyebab berbeda wavelet coefficients antara pre-Inversed dan embedded adalah karena angkat berkoma yang di convert ke integer menjadi selalu floor
 Solusi -> Round all element in InverseDWT 
